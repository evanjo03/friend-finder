<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Survey Page</title>

  <!-- Latest compiled and minified CSS & JS -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
  <script src="https://code.jquery.com/jquery.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
</head>

<body>

  <div class="container">

    <div class="jumbotron">
      <h1 class="text-center">
        <span class="fa fa-fire"></span>Friend Finder</h1>
      <hr>
      <h2 class="text-center">Take the quiz to see how you match up!</h2>
      <br>
      <div class="text-center">
        <a href="/survey">
          <button class="btn btn-lg btn-primary">
            <span class="fa fa-list-alt"></span> Take the Survey!</button>
        </a>
        <a href="/">
          <button class="btn btn-lg btn-default">
            <span class="fa fa-home"></span>
          </button>
        </a>
      </div>
    </div>
    <div class="row">
      <div class="col-lg-12">
        <div class="card" id="questions">
          <div class="card-header">
            Friend Survey
          </div>
          <div class="card-body">
            <form role="form">
              <div class="form-group">
                <label for="friend-name">Name</label>
                <input type="text" class="form-control" id="friend-name">
              </div>
              <div class="form-group">
                <label for="friend-image">Link to a photo of you</label>
                <input type="text" class="form-control" id="friend-image">
              </div>
              <div class="form-group">
                <label for="q1">I prefer spending time outside more than inside.</label>
                <select class="form-control custom-select" id="q1">
                  <option></option>
                  <option>1 (Do not agree)</option>
                  <option>2</option>
                  <option>3</option>
                  <option>4</option>
                  <option>5 (Agree)</option>
                </select>
              </div>
              <div class="form-group">
                <label for="q2">I like tasting new foods.</label>
                <select class="form-control" id="q2">
                  <option></option>
                  <option>1 (Do not agree)</option>
                  <option>2</option>
                  <option>3</option>
                  <option>4</option>
                  <option>5 (Agree)</option>
                </select>
              </div>
              <div class="form-group">
                <label for="q3">I enjoy meeting new people.</label>
                <select class="form-control" id="q3">
                  <option></option>
                  <option>1 (Do not agree)</option>
                  <option>2</option>
                  <option>3</option>
                  <option>4</option>
                  <option>5 (Agree)</option>
                </select>
              </div>
              <div class="form-group">
                <label for="q4">I enjoy travelling.</label>
                <select class="form-control" id="q4">
                  <option></option>
                  <option>1 (Do not agree)</option>
                  <option>2</option>
                  <option>3</option>
                  <option>4</option>
                  <option>5 (Agree)</option>
                </select>
              </div>
              <div class="form-group">
                <label for="q5">I like warm weather more than cold weather.</label>
                <select class="form-control" id="q5">
                  <option></option>
                  <option>1 (Do not agree)</option>
                  <option>2</option>
                  <option>3</option>
                  <option>4</option>
                  <option>5 (Agree)</option>
                </select>
              </div>
              <div class="form-group">
                <label for="q6">Tabs are better than spaces.</label>
                <select class="form-control" id="q6">
                  <option></option>
                  <option>1 (Do not agree)</option>
                  <option>2</option>
                  <option>3</option>
                  <option>4</option>
                  <option>5 (Agree)</option>
                </select>
              </div>
              <div class="form-group">
                <label for="q7">I drink my coffee black.</label>
                <select class="form-control" id="q7">
                  <option></option>
                  <option>1 (Do not agree)</option>
                  <option>2</option>
                  <option>3</option>
                  <option>4</option>
                  <option>5 (Agree)</option>
                </select>
              </div>
              <div class="form-group">
                <label for="q8">I prefer staying up late as opposed to waking up early.</label>
                <select class="form-control" id="q8">
                  <option></option>
                  <option>1 (Do not agree)</option>
                  <option>2</option>
                  <option>3</option>
                  <option>4</option>
                  <option>5 (Agree)</option>
                </select>
              </div>
              <div class="form-group">
                <label for="q9">My favorite language is python.</label>
                <select class="form-control" id="q9">
                  <option></option>
                  <option>1 (Do not agree)</option>
                  <option>2</option>
                  <option>3</option>
                  <option>4</option>
                  <option>5 (Agree)</option>
                </select>
              </div>
              <div class="form-group">
                <label for="q10">I dress for comfort, not style.</label>
                <select class="form-control" id="q10">
                  <option></option>
                  <option>1 (Do not agree)</option>
                  <option>2</option>
                  <option>3</option>
                  <option>4</option>
                  <option>5 (Agree)</option>
                </select>
              </div>
              <button type="submit" class="btn btn-primary submit">Submit</button>
            </form>
          </div>
        </div>
      </div>
    </div>
    <!-- Modal -->
    <div class="modal fade" id="exampleModalCenter" tabindex="-1" role="dialog"
      aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLongTitle">It's a match! Meet your new friend!</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
          </div>
        </div>
      </div>
    </div>
    <footer class="footer">
      <div class="container">
        <p>
          <a href="/api/friends" target="_blank">API Friend Link</a> | <a href="https://github.com/evanjo03/friend-finder" target="_blank">Github</a>
        </p>
      </div>

    </footer>

  </div>

</body>

</html>


<script type="text/javascript">



  //when the survey submit button is clicked
  $(".submit").on("click", function (event) {

    //input validation
    var allAnswered = true;

    for (i = 1; i < 11; i++) {
      if ($('#q' + i).val() === "") {
        allAnswered = false;
      }
    }
    if (allAnswered === true) {
      event.preventDefault();

      //assemble the quiz scores
      var scoreArray = [];
      for (i = 1; i < 11; i++) {
        scoreArray.push(parseInt($('#q' + i).val()));
      }

      // Here we grab the form elements
      var newFriend = {
        name: $("#friend-name").val().trim(),
        photo: $("#friend-image").val().trim(),
        scores: scoreArray
      };


      $.post("/api/friends", newFriend,
        function (data) {
          if (data) {

            //clear any previous data in the modal
            $('.modal-body').empty();

            //add our information to the modal
            $('.modal-body').append($("<h3>").html(data.matchName));
            var imageObject = $("<img>").attr('src', data.matchPhoto);
            imageObject.attr("class", "img-fluid")
            $('.modal-body').append(imageObject)

            //toggle the modal
            $('#exampleModalCenter').modal('toggle');

            // Clear the form when submitting the form
            $("#friend-name").val("");
            $("#friend-image").val("");
            for (i = 1; i < 11; i ++) {
              $('#q' + i).val("");
            };

          }
        });
    }
    else {
      //if one or more of the questions is left blank
      event.preventDefault();
      alert("Please fill out an answer for all questions!")
    }

  });

</script>